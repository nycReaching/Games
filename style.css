/* style.css - Mobile Responsive Overhaul */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

/* --- Base & Normal Mode Theme --- */
:root {
    --bg-main: #111827; /* Cool Gray 900 */
    --bg-panel: #1F2937; /* Cool Gray 800 */
    --bg-panel-accent: #374151; /* Cool Gray 700 */
    --text-primary: #F9FAFB; /* Gray 50 */
    --text-secondary: #9CA3AF; /* Gray 400 */
    --border-color: #4B5563; /* Gray 600 */
    
    --accent-blue: #3B82F6;
    --accent-pink: #EC4899;
    --accent-yellow: #F59E0B;
    --accent-green: #10B981;
    --accent-orange: #F97316;
    --accent-red: #EF4444;
    
    --multiplier-2x-color: #3B82F6;
    --multiplier-3x-color: #A855F7;
    --multiplier-5x-color: #EC4899;

    --font-primary: 'Poppins', sans-serif;
    --border-radius-main: 12px;
    --border-radius-small: 8px;
    --shadow-subtle: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-strong: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

/* --- Cosmic Mode Theme --- */
body.cosmic-theme {
    --bg-main: #1E1B4B; /* Deep Indigo */
    --bg-panel: #312E81; /* Mid Indigo */
    --bg-panel-accent: #4338CA; /* Bright Indigo */
    --text-primary: #E0E7FF; /* Lavender White */
    --text-secondary: #A5B4FC; /* Light Indigo */
    --border-color: #4F46E5; /* Indigo 600 */
    
    --accent-yellow: #FACC15; /* Star Yellow */
    --accent-green: #4ADE80; /* Nebula Green */
    --accent-blue: #60A5FA; /* Sky Blue */
    --accent-pink: #F472B6; /* Space Pink */

    background: radial-gradient(ellipse at bottom, var(--bg-main) 0%, #000 100%);
}

/* --- Quantum Mode Theme --- */
body.quantum-theme {
    --bg-main: #0D2A24; /* Very Dark Teal */
    --bg-panel: #04443A; /* Dark Teal */
    --bg-panel-accent: #065F46; /* Mid Teal */
    --text-primary: #ECFDF5; /* Mint White */
    --text-secondary: #A7F3D0; /* Light Mint */
    --border-color: #059669; /* Emerald 600 */

    --accent-yellow: #FBBF24; /* Amber */
    --accent-green: #34D399; /* Vibrant Mint */
    --accent-blue: #38BDF8; /* Vibrant Sky Blue */
    --accent-pink: #FB7185; /* Vibrant Rose */

    background-color: var(--bg-main);
    background-image: linear-gradient(var(--bg-panel-accent) 1px, transparent 1px), linear-gradient(to right, var(--bg-panel-accent) 1px, transparent 1px);
    background-size: 25px 25px;
}


/* --- Animations --- */
@keyframes popIn {
    0% { opacity: 0; transform: translateY(15px) scale(0.95); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes pulseWarningBorder {
    0%, 100% { border-color: var(--accent-red); box-shadow: 0 0 5px var(--accent-red); }
    50% { border-color: var(--accent-orange); box-shadow: 0 0 8px var(--accent-orange); }
}

@keyframes pulseSymbol {
    0%, 50%, 100% { transform: scale(1); }
    25%, 75% { transform: scale(1.4); color: var(--accent-yellow); }
}

@keyframes glow {
    0% { box-shadow: 0 0 3px var(--text-primary); }
    50% { box-shadow: 0 0 10px var(--accent-blue), 0 0 12px var(--accent-blue); }
    100% { box-shadow: 0 0 3px var(--text-primary); }
}
.selectable-pet {
    animation: glow 2s infinite ease-in-out;
    border-color: var(--accent-blue) !important;
}


.symbol-pulse-animation {
    animation: pulseSymbol 1.2s ease-in-out;
}

/* --- General Styles --- */
html {
    box-sizing: border-box;
}
*, *:before, *:after {
    box-sizing: inherit;
}
body {
    font-family: var(--font-primary);
    background: var(--bg-main);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    min-height: 100vh;
    color: var(--text-primary);
    padding: 1rem 1rem 150px 1rem; /* Added safe area for bottom nav */
    transition: background 0.5s ease;
    overflow-x: hidden;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
    margin: 0;
}

/* --- Game Title Styling --- */
#game-main-title {
    font-size: clamp(1rem, 4vw, 1.1rem);
    font-weight: 600;
    color: var(--text-primary);
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin: 0 auto 1rem auto;
    transition: all 0.3s ease-in-out;
}
#game-main-title.upgrade-mode-active {
    font-size: clamp(1.1rem, 4.5vw, 1.25rem);
    font-weight: 700;
    letter-spacing: 2px;
    color: var(--accent-yellow);
    text-shadow: 0 0 8px var(--accent-yellow);
}

.main-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    width: 100%;
    max-width: 480px; /* Increased max-width for better tablet view */
}

/* --- Panel Styling --- */
.game, .modal-window {
    background: var(--bg-panel);
    border-radius: var(--border-radius-main);
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-strong);
    padding: clamp(12px, 4vw, 16px);
    transition: background 0.3s ease, border-color 0.3s ease;
}

/* --- Game Area --- */
.game {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    width: 100%;
    text-align: center;
    gap: 0.75rem;
}
.game.food-warning {
    background: #450a0a !important; /* Dark red */
    border-color: var(--accent-red) !important;
}
.game.food-warning .food-meter-icon, .game.food-warning .food-meter-value { color: var(--text-primary); }

/* Meters (Food & Power) */
.meters-wrapper {
    display: flex;
    gap: 0.75rem;
    width: 100%;
}
.power-meter-container, .food-meter-container { 
    display: flex; 
    align-items: center; 
    gap: 0.5rem; 
    flex: 1;
    min-width: 0;
}
.power-meter-bar, .food-meter { 
    flex-grow: 1;
    height: 1rem; 
    background-color: var(--bg-main); 
    border: 1px solid var(--border-color); 
    border-radius: var(--border-radius-small); 
    overflow: hidden; 
}
.power-meter-fill { height: 100%; background: linear-gradient(to right, var(--accent-yellow), var(--accent-orange)); transition: width 0.4s ease; }
.food-meter-fill { height: 100%; background: linear-gradient(to right, var(--accent-green), #059669); transition: width 0.4s ease; }
#power-meter-indicator-icon, .food-meter-icon { font-size: clamp(1.25rem, 5vw, 1.5rem); flex-shrink: 0;}
.next-power-bill-display, .food-meter-value { font-size: clamp(0.7rem, 2.5vw, 0.75rem); font-weight: 500; color: var(--text-secondary); flex-shrink: 0; white-space: nowrap; }
.food-icon-area { display: flex; flex-direction: column; align-items: center; }

/* Symbol Inventory */
.symbol-inventory {
    padding: 0.5rem;
    font-size: clamp(1rem, 4vw, 1.1rem);
    color: var(--text-secondary);
    min-height: 58px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(42px, 1fr));
    gap: 0.5rem;
    align-items: center;
    background: rgba(0,0,0,0.2);
    border: 1px solid var(--bg-main);
    border-radius: var(--border-radius-small);
    width: 100%;
}
.symbol-inventory span { transition: transform 0.2s ease, color 0.2s ease; }
.symbol-inventory span:hover { transform: scale(1.15); color: var(--accent-pink); }

/* Slot Grid */
.slot-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: clamp(8px, 2vw, 12px);
    width: 100%;
}
.slot-cell {
    width: 100%;
    aspect-ratio: 1 / 1;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: clamp(1.75rem, 8vw, 2.25rem);
    background: var(--bg-panel-accent);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-small);
    position: relative;
    cursor: default;
    transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background-color 0.2s ease;
    box-shadow: var(--shadow-subtle);
}
.slot-cell.anim-popIn { animation: popIn 0.4s ease-out forwards; opacity: 0; }
.slot-cell:hover { transform: translateY(-2px); box-shadow: var(--shadow-strong); }
.slot-cell.clickable-food, .slot-cell.clickable-cat { cursor: pointer; }

/* Text inside Slot Cells */
.slot-cell .base-value-text {
    position: absolute;
    top: 3px;
    left: 4px;
    font-size: clamp(0.8rem, 3vw, 0.9rem);
    font-weight: 700;
    color: var(--accent-yellow);
    text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
    pointer-events: none;
    transition: all 0.3s ease;
}
.slot-cell .base-value-text.multiplied-payout {
    font-size: clamp(0.9rem, 3.5vw, 1rem);
    text-shadow: 0 0 5px var(--accent-yellow), 0 0 10px var(--accent-orange);
    transform: scale(1.1);
}

.multiplier-value-text { position: absolute; top: 3px; right: 4px; font-size: clamp(0.8rem, 3vw, 0.9rem); font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); pointer-events: none; }

/* Cell States */
.slot-cell.top-right-locked { background-color: var(--accent-orange); border-color: var(--accent-yellow); }
.lock-icon { position: absolute; top: 0px; right: 1px; font-size: 1rem; z-index: 20; }
.lock-icon.locked-state { color: var(--accent-yellow); }
.lock-icon.no-locks { opacity: 0.5; color: var(--text-secondary); }

.slot-cell.multi-2x { background-color: color-mix(in srgb, var(--multiplier-2x-color) 25%, transparent); border-color: var(--multiplier-2x-color); }
.slot-cell.multi-3x { background-color: color-mix(in srgb, var(--multiplier-3x-color) 25%, transparent); border-color: var(--multiplier-3x-color); }
.slot-cell.multi-5x { background-color: color-mix(in srgb, var(--multiplier-5x-color) 25%, transparent); border-color: var(--multiplier-5x-color); }
.slot-cell.multi-2x .multiplier-value-text { color: var(--multiplier-2x-color); }
.slot-cell.multi-3x .multiplier-value-text { color: var(--multiplier-3x-color); }
.slot-cell.multi-5x .multiplier-value-text { color: var(--multiplier-5x-color); }

/* Schrodinger Cat Effect */
.schrodinger-cat-effect {
    box-shadow: 0 0 10px var(--accent-green), inset 0 0 6px var(--accent-green) !important;
    border: 1px dashed var(--accent-green) !important;
}
.schrodinger-cat-effect::after { content: "🐈"; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2.5rem; z-index: 5; pointer-events: none; color: transparent; background: linear-gradient(45deg, var(--accent-green), var(--accent-blue)); -webkit-background-clip: text; background-clip: text; opacity: 0.6; }

/* Win Displays */
.win-display, .phone-message-display { font-size: clamp(0.85rem, 3vw, 0.9rem); font-weight: 500; min-height: 22px; text-align: center; }
.win-display { color: var(--accent-yellow); }
.win-display.game-over { color: var(--accent-red); font-size: clamp(1rem, 3.5vw, 1.1rem); font-weight: bold; }
.phone-message-display.friendly, .phone-message-display.profit { color: var(--accent-green); }
.phone-message-display.loss { color: var(--accent-red); }
.phone-message-display.takeout-confirm { color: var(--accent-blue); }

/* Controls & Buttons */
.controls { display: flex; gap: 0.75rem; align-items: stretch; justify-content: center; width: 100%; }
.btn { padding: 0.75rem 1rem; font-size: clamp(0.85rem, 3.5vw, 1rem); border: 1px solid transparent; border-radius: var(--border-radius-small); cursor: pointer; transition: all 0.2s ease; box-shadow: var(--shadow-subtle); font-weight: 600; text-transform: uppercase; background: var(--accent-blue); color: #FFFFFF; }
.btn:hover:not(:disabled) { transform: translateY(-1px); box-shadow: var(--shadow-strong); filter: brightness(1.1); }
.btn:disabled { cursor: not-allowed; filter: brightness(0.6); }
.btn-spin { flex-grow: 1; }
.btn-lucky { flex-shrink: 0; padding: 0.75rem; }
.btn-lucky.active { background: var(--accent-pink); }
.btn-spin.btn-spin-lucky { background: var(--accent-pink); }
.btn.btn-spin-bill-unpaid { animation: pulseWarningBorder 1.2s infinite; background: var(--accent-red); }

.coin-display { font-size: clamp(1rem, 4vw, 1.1rem); font-weight: bold; color: var(--text-primary); }

/* Inventory Window */
.inventory-window { width: 100%; padding: 0.75rem; background: rgba(0,0,0,0.2); border: 1px solid var(--bg-main); border-radius: var(--border-radius-small);}
.inventory-content { display: flex; flex-wrap: wrap; justify-content: center; gap: 0.5rem; font-size: clamp(0.8rem, 3.5vw, 0.9rem); }
.inventory-item { padding: 0.4rem 0.6rem; background: var(--bg-panel); border-radius: var(--border-radius-small); box-shadow: var(--shadow-subtle); color: var(--text-secondary); border: 1px solid var(--border-color); }
.inventory-item.clickable { cursor: pointer; color: var(--accent-blue); }
.inventory-item.clickable:hover { color: var(--accent-pink); transform: scale(1.05); }
.inventory-item-gift { color: var(--accent-yellow) !important; font-weight: bold;}
.inventory-item.clickable[style*="opacity: 0.7"] { cursor: not-allowed; color: var(--text-secondary); transform: none; }

/* --- Fixed Bottom Navigation Bar --- */
.bottom-nav-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: var(--bg-panel);
    border-top: 1px solid var(--border-color);
    box-shadow: 0 -4px 10px rgba(0,0,0,0.2);
    z-index: 500;
    padding: 0.5rem 0.75rem;
    transition: background-color 0.3s ease, border-color 0.3s ease;
}
.bottom-utility-section { display: flex; flex-direction: column; gap: 0.5rem; width: 100%; }
.status-effects-window {
    width: 100%; 
    display: flex; 
    align-items: center;
    gap: 0.25rem;
    overflow-x: auto;
    white-space: nowrap;
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
    padding-bottom: 0.5rem; /* Space for scrollbar */
}
.status-effects-window::-webkit-scrollbar { height: 4px; }
.status-effects-window::-webkit-scrollbar-track { background: transparent; }
.status-effects-window::-webkit-scrollbar-thumb { background: var(--bg-panel-accent); border-radius: 4px; }

.status-effect-item {
    display: inline-flex; 
    flex-direction: row;
    align-items: center; 
    gap: 0.25rem;
    background: var(--bg-main);
    padding: 0.25rem 0.5rem;
    border-radius: var(--border-radius-small);
    flex-shrink: 0; /* Important for overflow */
}
.buff-emoji { font-size: 0.8rem; }
.buff-countdown { font-size: 0.75rem; font-weight: bold; color: var(--accent-yellow); }
.buff-value { font-size: 0.75rem; font-weight: bold; color: var(--accent-green); }

.bottom-controls-bar { display: flex; justify-content: space-around; gap: 0.5rem; width: 100%; }
.utility-trigger { flex: 1; display: flex; justify-content: center; align-items: center; }
.utility-btn {
    font-size: clamp(1.2rem, 5vw, 1.5rem);
    width: clamp(44px, 12vw, 52px);
    height: clamp(44px, 12vw, 52px);
    border-radius: var(--border-radius-main);
    background-color: var(--bg-panel-accent);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid var(--border-color);
    color: var(--text-primary);
}
.utility-btn:hover { background-color: var(--bg-main); color: var(--accent-blue); }
.utility-btn.toggled-off { background-color: var(--bg-main); color: var(--text-secondary); }

/* --- Modals --- */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(4px); display: flex; justify-content: center; align-items: center; z-index: 1000; transition: opacity 0.3s ease; padding: 1rem; }
.modal-overlay.hidden { opacity: 0; pointer-events: none; }
.modal-window { width: 100%; max-width: 500px; max-height: 90vh; position: relative; display: flex; flex-direction: column; }
.modal-title { font-size: 1.2rem; color: var(--accent-blue); text-align: center; margin: 0 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 1px solid var(--accent-blue); }
.modal-close-btn { position: absolute; top: 8px; right: 12px; font-size: 2rem; color: var(--text-secondary); background: none; border: none; cursor: pointer; z-index: 1001; padding: 0; line-height: 1; }
.modal-close-btn:hover { color: var(--accent-pink); }
.modal-content { overflow-y: auto; font-size: 0.9rem; line-height: 1.6; padding: 0.5rem; }
.modal-content strong { color: var(--accent-yellow); }
.modal-content hr {
    border-color: var(--border-color);
    margin: 1rem 0;
    border-style: solid;
    border-width: 1px 0 0 0;
}
/* Payout Modal Highlight */
.payout-option.highlight {
    color: var(--accent-yellow);
    font-weight: bold;
    background-color: color-mix(in srgb, var(--accent-yellow) 20%, transparent);
    padding: 2px 5px;
    border-radius: 4px;
    display: inline-block;
}


/* Shop Modal */
#shop-modal-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 0.75rem; }
.shop-item-btn {
    padding: 0.5rem;
    font-size: 0.8rem;
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-small);
    cursor: pointer;
    transition: all 0.2s ease;
    font-weight: 500;
    text-align: center;
    background-color: var(--bg-panel-accent);
    color: var(--text-primary);
    box-shadow: var(--shadow-subtle);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 0.25rem;
}
.shop-item-cost {
    font-weight: bold;
    display: inline-block;
    color: var(--bg-main) !important;
    background: var(--accent-yellow);
    padding: 2px 6px;
    border-radius: 6px;
    font-size: 0.85rem;
}
.shop-item-btn:hover:not(:disabled) { transform: translateY(-2px); border-color: var(--accent-blue); background-color: var(--bg-panel); }
.shop-item-btn:disabled { filter: grayscale(0.7) brightness(0.7); cursor: not-allowed; }

/* Phone Modal */
#phone-modal-content .btn { width: 90%; max-width: 300px; margin: 0.75rem auto; display: block; }
#investments-btn { background: var(--accent-green); }
#takeout-area { background: var(--accent-orange); }
.investment-ui, .takeout-ui { display: flex; flex-direction: column; gap: 1rem; padding: 1rem; }
.investment-ui input[type="range"], .takeout-ui input[type="range"] { accent-color: var(--accent-pink); }
.investment-ui #invest-amount-display, .takeout-ui #takeout-amount-display { font-size: 1.2rem; font-weight: bold; text-align: center; }

/* Pet Modal */
#pet-modal-content { display: flex; flex-direction: column; justify-content: flex-start; align-items: center; padding: 0.25rem; min-height: 220px; }
.pet-info-container { text-align: center; width: 100%; }
.pet-status-emoji { font-size: 3.5rem; }
.pet-description { font-size: 0.85rem; color: var(--text-primary); min-height: 1.2rem; font-weight: 500; margin-top: 0.25rem; }
.pet-bottom-area { width: 100%; text-align: center; margin-top: 0.5rem; }
#pet-toy-display { font-size: 1.5rem; }
.pet-food-consumption { font-size: 0.75rem; color: var(--text-secondary); }
.alien-visitor-text { font-size: 0.9rem; font-weight: bold; color: var(--accent-green); line-height: 1.4; text-align: center; }
.alien-emoji-large { font-size: 3.5rem; }

/* Guide Modal */
#guide-icons-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; max-width: 200px; margin: 1rem auto; }
.guide-icon { font-size: 2.5rem; cursor: pointer; transition: transform 0.2s ease; text-align: center; }
.guide-icon:hover { transform: scale(1.15); color: var(--accent-pink); }
#guide-back-btn { display: block; width: 90%; max-width: 300px; margin: 0 auto 1rem auto; }
.guide-topic-content h4 { font-size: 1.1rem; color: var(--accent-blue); margin-top: 0.75rem; margin-bottom: 0.5rem; border-bottom: 1px solid var(--bg-panel-accent); padding-bottom: 0.25rem; }
.guide-topic-content ul { list-style-type: none; padding-left: 0; margin-bottom: 0.5rem; }
.guide-topic-content li { margin-bottom: 0.5rem; }
.btn.btn-how-to-play {
    background: var(--accent-pink);
    display: block;
    width: 90%;
    max-width: 300px;
    margin: 0 auto 1rem auto;
}

/* Gift Modal */
#gift-choice-content h4 { font-size: 1.25rem; color: var(--accent-yellow); text-align: center; border: none; }
#gift-choice-content p { text-align: center; margin-bottom: 1.5rem; }
.gift-choices-container { display: flex; flex-direction: column; gap: 1rem; align-items: stretch; width: 100%; }
