/* style.css - Cyber Glow Refresh - Final Refinements */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

/* --- Base Variables --- */
:root {
    --bg-main: #0A0F1E; /* Very dark desaturated blue */
    --bg-panel: #141A2E; /* Darker blue/purple */
    --bg-panel-accent: #1E243E; /* Slightly lighter for modals/accented panels */
    --text-primary: #D0D8E8; /* Light greyish blue */
    --text-secondary: #A0A8C0;
    --accent-blue: #00DFFC;
    --accent-pink: #F800B8;
    --accent-yellow: #F8D800;
    --accent-green: #00F8A8;
    --accent-orange: #F88800;
    --accent-red: #F84800; /* For warnings/errors */

    /* New Bright Accent Colors for Shop/Upgrades */
    --accent-teal: #00F0D0;
    --accent-magenta: #F000F0;
    --accent-lime: #A0F800; /* Lime Green for Quantum */

    /* Multiplier Colors */
    --multiplier-2x-color: #009688; /* Teal */
    --multiplier-3x-color: #9C27B0; /* Purple */
    --multiplier-5x-color: #F44336; /* Red */


    --font-primary: 'Poppins', sans-serif;
    --border-radius-main: 10px;
    --border-radius-small: 6px;
    --shadow-color: rgba(0, 223, 252, 0.1);
    --shadow-color-pink: rgba(248, 0, 184, 0.1);
    --shadow-strong: 0 0 12px var(--shadow-color), 0 0 24px var(--shadow-color);
    --shadow-subtle: 0 3px 12px rgba(0,0,0,0.3);
}

/* --- Animations Redefined --- */
@keyframes popIn {
    0% { opacity: 0; transform: translateY(20px) scale(0.9); }
    70% { opacity: 1; transform: translateY(-6px) scale(1.02); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes payoutShow {
    0% { transform: translateY(12px) scale(0.7); opacity: 0; }
    60% { transform: translateY(-6px) scale(1.15); opacity: 1; }
    100% { transform: translateY(0) scale(1.1); opacity: 1; }
}
@keyframes payoutHide {
    0% { transform: translateY(0) scale(1.1); opacity: 1; }
    100% { transform: translateY(-20px) scale(0.4); opacity: 0; }
}

@keyframes accentGlow {
    0%, 100% { text-shadow: 0 0 4px var(--accent-blue), 0 0 8px var(--accent-blue), 0 0 12px var(--accent-blue); }
    50% { text-shadow: 0 0 6px var(--accent-blue), 0 0 12px var(--accent-blue), 0 0 20px var(--accent-blue); }
}
@keyframes pinkGlow {
    0%, 100% { text-shadow: 0 0 4px var(--accent-pink), 0 0 8px var(--accent-pink); }
    50% { text-shadow: 0 0 6px var(--accent-pink), 0 0 12px var(--accent-pink); }
}
@keyframes limeGlow { /* For Quantum Mode */
    0%, 100% { text-shadow: 0 0 4px var(--accent-lime), 0 0 8px var(--accent-lime), 0 0 12px var(--accent-lime); }
    50% { text-shadow: 0 0 6px var(--accent-lime), 0 0 12px var(--accent-lime), 0 0 20px var(--accent-lime); }
}
@keyframes yellowGlow {
    0%, 100% { text-shadow: 0 0 4px var(--accent-yellow), 0 0 8px var(--accent-yellow); }
    50% { text-shadow: 0 0 6px var(--accent-yellow), 0 0 12px var(--accent-yellow); }
}


@keyframes investmentResult {
    0% { transform: scale(0.7); opacity: 0; }
    60% { transform: scale(1.1); opacity: 1; }
    100% { transform: scale(1); opacity: 1; }
}

@keyframes pulseWarningBorder {
    0% { box-shadow: 0 0 6px var(--accent-red), inset 0 0 4px var(--accent-red); border-color: var(--accent-red); }
    50% { box-shadow: 0 0 12px var(--accent-orange), inset 0 0 6px var(--accent-orange); border-color: var(--accent-orange); }
    100% { box-shadow: 0 0 6px var(--accent-red), inset 0 0 4px var(--accent-red); border-color: var(--accent-red); }
}
.btn-spin-bill-unpaid {
    animation: pulseWarningBorder 1.2s infinite;
    border: 2px solid var(--accent-red) !important;
}
.btn-lucky.active { 
    background: linear-gradient(135deg, var(--accent-pink), var(--accent-yellow)) !important;
    border-color: var(--accent-pink) !important;
    color: var(--bg-main) !important;
    box-shadow: 0 0 8px var(--accent-pink), 0 0 4px var(--accent-yellow);
}

/* --- General Styles --- */
body {
    font-family: var(--font-primary);
    background: var(--bg-main);
    display: flex;
    flex-direction: column; /* For title alignment */
    justify-content: flex-start; /* Align title and then container */
    align-items: center;
    min-height: 100vh;
    color: var(--text-primary);
    padding: 15px;
    box-sizing: border-box;
    transition: background 0.5s ease, color 0.5s ease;
    overflow-x: hidden;
}

/* --- Game Title Styling --- */
#game-main-title {
    font-size: 20px;
    font-weight: 700;
    color: var(--accent-blue);
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin: 0 auto 12px auto;
    transition: all 0.4s ease-in-out;
    line-height: 1.2;
    text-align: center;
    width: 100%;
}

#game-main-title.upgrade-mode-active { /* General style for active upgrade titles */
    font-size: 22px;
    font-weight: bold;
    letter-spacing: 3px;
}
/* Specific glows will be handled by theme classes */


.main-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 20px;
    flex-wrap: wrap-reverse; /* Put game on left on smaller screens */
    max-width: 1200px;
}

/* --- Panel Styling --- */
.status-effects-window, .game, .inventory-window,
.modal-window, .utility-trigger {
    background: var(--bg-panel);
    border-radius: var(--border-radius-main);
    box-shadow: 0 4px 15px rgba(0,0,0,0.5), 0 0 6px var(--shadow-color) inset;
    border: 1px solid transparent;
    padding: 15px;
    transition: background 0.5s ease, border-color 0.5s ease, box-shadow 0.3s ease;
    box-sizing: border-box;
}
.game:hover {
     box-shadow: 0 6px 20px rgba(0,0,0,0.6), 0 0 10px var(--shadow-color-pink) inset;
}

/* Guide Icons now in modal */
#guide-selection-modal-content #guide-icons-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 columns for modal */
    gap: 12px;
    width: 100%;
    max-width: 200px;
    margin: 12px auto;
}

#guide-selection-modal-content .guide-icon {
    font-size: 36px; /* Larger in modal */
    cursor: pointer;
    padding: 8px;
    border-radius: var(--border-radius-small);
    transition: transform 0.2s ease, color 0.2s ease;
    color: var(--text-primary);
    text-align: center;
}
#guide-selection-modal-content .guide-icon:hover {
    transform: scale(1.15);
    color: var(--accent-pink);
}


/* Shop content now in modal */
#shop-modal-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
    gap: 10px;
    padding: 12px 4px;
    align-items: stretch;
    overflow-y: auto;
}

/* Pet Modal Refinements */
#pet-modal-content {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    padding: 4px;
    min-height: 220px;
    box-sizing: border-box;
}
.pet-info-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 2px;
    width: 100%;
    flex-grow: 1;
    padding: 1px 0;
}
.pet-main-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    width: 100%;
}
.pet-display {
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 52px;
}
.pet-status-emoji {
    font-size: 48px;
}
.pet-description {
    font-size: 13px;
    color: var(--text-primary);
    min-height: 18px;
    font-weight: 500;
    text-align: center;
    line-height: 1.2;
    width: 90%;
    margin-top: 4px;
}

.pet-bottom-area {
    width: 100%;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    padding-bottom: 2px;
    margin-top: 4px;
}
#pet-toy-display {
    font-size: 22px;
    line-height: 1;
    min-height: 24px;
}
.alien-visitor-text {
    font-size: 14px;
    font-weight: bold;
    color: var(--accent-green);
    text-shadow: 0 0 4px var(--accent-green);
    line-height: 1.3;
    text-align: center;
    width: 100%;
    padding: 4px 0;
}
.alien-emoji-large {
    font-size: 48px;
    line-height: 1;
    display: inline-block;
    margin-bottom: 4px;
}
.pet-food-consumption {
    font-size: 11px;
    color: var(--text-secondary);
    width: 100%;
    text-align: center;
    line-height: 1;
}


/* Phone Modal & UI Refinements */
#phone-modal-content .btn {
    width: 80%;
    margin: 10px auto;
    display: block;
}
/* ADDED: Phone button colors */
#investments-btn {
    background: linear-gradient(145deg, var(--accent-green), #00b377) !important;
}
#takeout-area {
    background: linear-gradient(145deg, var(--accent-orange), #d4a200) !important;
}


.feature-countdown { font-size: 12px; font-weight: bold; color: var(--accent-yellow); line-height: 1; margin-left: 6px;}

.phone-message-display {
    font-size: 14px;
    font-weight: 500;
    min-height: 20px;
    text-align: center;
    margin-bottom: 8px;
    transition: opacity 0.5s ease-out;
}
.phone-message-display.friendly { color: var(--accent-green); }
.phone-message-display.loss { color: var(--accent-red); }
.phone-message-display.profit { color: var(--accent-green); font-weight: bold; }
.phone-message-display.takeout-confirm { color: var(--accent-blue); }

.investment-ui, .takeout-ui {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
    box-sizing: border-box;
    width: 100%;
    justify-content: center;
    padding: 15px;
}
.investment-ui span:first-child,
.takeout-ui span:first-child {
    font-size: 13px; 
    line-height: 1.3;
    color: var(--text-secondary);
    margin-bottom: 4px;
    text-align: center;
    word-wrap: break-word;
}
.investment-ui #invest-amount-display,
.takeout-ui #takeout-amount-display {
    font-size: 18px; 
    font-weight: bold;
    color: var(--text-primary);
    text-align: center;
    margin: 4px 0;
}
.investment-ui input[type="range"],
.takeout-ui input[type="range"] {
    width: 100%;
    cursor: pointer;
    accent-color: var(--accent-pink); /* Will be overridden by theme if needed */
    margin: 8px 0; 
}
.investment-ui button,
.takeout-ui button {
    margin-top: 8px; 
    padding: 10px 14px; 
    font-size: 15px;
}

/* REMOVED: All old window modal styles */

/* UPDATED Power Bar (Horizontal) */
.power-meter-container { 
    display: flex; 
    align-items: center; 
    gap: 8px; 
    width: 100%; 
    padding: 4px 0;
    flex-direction: row; 
    margin-bottom: 8px;
    background: none;
    border-radius: 0;
    box-shadow: none;
    border: none;
}
#power-meter-indicator-icon { 
    font-size: 22px; 
    color: var(--accent-blue); 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    gap: 2px; 
    min-height: 24px;
    flex-shrink: 0;
}
.power-penalty-indicator { font-size: 14px; }
.quantum-indicator { color: var(--accent-lime); }
.cosmic-indicator { color: var(--accent-pink); }
.power-meter-bar { 
    width: 100%; 
    height: 16px; 
    background-color: var(--bg-panel-accent); 
    border: 1px solid var(--accent-blue); 
    border-radius: var(--border-radius-small); 
    position: relative; 
    overflow: hidden; 
    box-shadow: inset 0 0 4px rgba(0,0,0,0.5);
    flex-grow: 1;
}
.power-meter-fill { 
    height: 100%; 
    background: linear-gradient(to right, var(--accent-yellow), var(--accent-orange)); 
    position: absolute; 
    top: 0; 
    left: 0; 
    transition: width 0.4s ease-in-out, background 0.5s ease; 
    border-radius: 5px 0 0 5px; 
}
.next-power-bill-display { 
    font-size: 10px; 
    font-weight: 500; 
    color: var(--text-secondary); 
    text-align: center; 
    line-height: 1.2; 
    width: auto;
    flex-shrink: 0;
}

/* NEW Bottom Utility Bar */
.bottom-utility-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 100%;
    margin-top: 15px;
}
/* UPDATED: Status effects window to be more flexible */
.status-effects-window { 
    padding: 8px;
    width: 100%; 
    min-height: 60px; /* Let it grow if needed */
    display: flex; 
    flex-direction: row; 
    justify-content: center; 
    align-items: center;
    gap: 6px; 
    font-size: 11px; 
    color: var(--text-primary); 
    text-align: center; 
    flex-grow: 1;
    flex-wrap: wrap; /* Allow wrapping on small screens */
}
.status-effect-item { 
    min-height: 20px; 
    line-height: 1; 
    display: flex; 
    flex-direction: column;
    justify-content: center; 
    align-items: center; 
    gap: 4px;
    flex: 1; 
    min-width: 40px; /* Give each buff item a min width */
}
.buff-emoji { font-size: 18px; }
.buff-countdown { font-size: 14px; font-weight: bold; color: var(--accent-yellow); margin-top: 1px; }
.buff-value { font-size: 12px; font-weight: bold; color: var(--accent-green); }


.bottom-controls-bar {
    display: flex;
    justify-content: space-around;
    align-items: center;
    gap: 6px;
    width: 100%;
}
.utility-trigger {
    padding: 0;
    width: auto;
    flex: 1;
    height: 50px;
    display: flex;
    justify-content: center;
    align-items: center;
    background: transparent;
    border: none;
    box-shadow: none;
}
.utility-btn {
    font-size: 26px;
    width: 44px;
    height: 44px;
    border-radius: var(--border-radius-small);
    background-color: var(--bg-panel);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid var(--accent-blue);
    color: var(--accent-blue);
}
.utility-btn:hover {
    background-color: var(--bg-panel-accent);
    color: var(--accent-pink);
    border-color: var(--accent-pink);
    transform: scale(1.05);
}
/* ADDED: Style for toggled off window button */
.utility-btn.toggled-off {
    background-color: var(--bg-panel-accent);
    color: var(--text-secondary);
    border-color: var(--text-secondary);
}


/* Shop Item Button Refinements */
.shop-item-btn {
    padding: 6px 8px;
    font-size: 12px;
    border: 1px solid var(--accent-teal); /* Default shop item color */
    border-radius: var(--border-radius-small);
    cursor: pointer;
    transition: background-color 0.3s ease, filter 0.3s ease, opacity 0.2s ease, transform 0.2s ease;
    font-weight: 500;
    text-align: center;
    background-color: var(--accent-teal);
    color: var(--bg-main);
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    width: 100%;
    opacity: 1;
    line-height: 1.3;
}
/* UPDATED: Shop item cost color */
.shop-item-cost {
    font-weight: bold;
    display: block;
    margin-top: 2px;
    color: #9C27B0; /* Purple */
}

.shop-item-btn:not(:disabled) {
    filter: brightness(1.05);
}
.shop-item-btn:hover:not(:disabled) {
    filter: brightness(1.15);
    transform: translateY(-1px);
}
.shop-item-btn:disabled {
    background-color: var(--accent-teal); /* Keep base color but dim */
    color: var(--bg-main);
    border-color: var(--accent-teal);
    cursor: not-allowed;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    opacity: 0.6;
    transform: none;
    filter: brightness(0.85);
}

/* --- Game Area --- */
/* UPDATED: Added text-align to help center inline-grid */
.game {
    padding: 15px;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    width: 100%;
    max-width: 420px;
    box-sizing: border-box;
    text-align: center; /* This will center the new inline-grid */
}
.game.food-warning {
    background: var(--accent-red) !important;
    border-color: var(--accent-orange) !important;
    box-shadow: 0 0 15px var(--accent-red), 0 0 8px var(--accent-red) inset !important;
}
.game.food-warning .food-meter-icon, .game.food-warning .food-meter-value { color: var(--bg-main); }

/* UPDATED Food Bar */
.food-meter-container { width: 100%; display: flex; align-items: center; gap: 6px; margin-bottom: 12px; font-size: 18px; font-weight: bold; color: var(--text-primary); }
.food-icon-area { display: flex; flex-direction: column; align-items: center; text-align: center; width: 40px; }
.food-meter-icon { font-size: 24px; line-height: 1; color: var(--accent-green); }
.food-meter-value { font-size: 11px; font-weight: 500; color: var(--text-secondary); margin-top: 2px; line-height: 1; }
.food-meter { flex-grow: 1; background-color: var(--bg-panel-accent); border: 1px solid var(--accent-green); border-radius: var(--border-radius-small); height: 16px; overflow: hidden; box-shadow: inset 0 1px 3px rgba(0,0,0,0.4); }
.food-meter-fill { height: 100%; background: linear-gradient(to left, var(--accent-green), #00b377); width: 100%; transition: width 0.4s ease-in-out, background 0.5s ease; border-radius: 5px 0 0 5px; }

/* UPDATED: Symbol inventory layout */
.symbol-inventory {
    margin: 8px auto 12px; /* Use auto margin for centering */
    padding: 8px;
    font-size: 18px;
    text-align: center;
    color: var(--text-secondary);
    min-height: 60px; /* Set min-height for 2 rows to prevent layout shift */
    display: grid;
    grid-template-columns: repeat(5, 1fr); /* 5 emojis across */
    gap: 8px;
    align-items: center;
    background: rgba(0,0,0,0.1);
    border-radius: var(--border-radius-small);
    width: 100%;
    box-sizing: border-box;
}
.symbol-inventory span {
    margin: 0;
    display: inline-block;
    transition: transform 0.2s ease;
    padding: 0;
    background: none;
    border-radius: 0;
}
.symbol-inventory span:hover {
    transform: scale(1.15);
    color: var(--accent-pink);
}

/* UPDATED: New robust centering for slot grid */
.slot-grid {
    display: inline-grid; /* Changed to inline-grid */
    grid-template-columns: repeat(4, clamp(60px, 18vw, 70px)); /* Responsive but definite columns */
    gap: clamp(5px, 2vw, 10px);
    position: relative;
    margin-bottom: 10px;
    /* Removed width and margin: auto */
}

/* Win Display Refinement */
.win-display {
    font-size: 16px;
    font-weight: bold;
    color: var(--accent-yellow);
    margin-top: 0px;
    margin-bottom: 4px;
    min-height: 20px;
    text-align: center;
    text-shadow: 0 0 4px rgba(248, 216, 0, 0.6);
}
.win-display.game-over {
    color: var(--accent-red);
    text-shadow: none;
    font-size: 18px;
}

/* UPDATED: Make slot cells responsive */
.slot-cell {
    width: 100%;
    aspect-ratio: 1 / 1; /* Maintain square shape */
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: clamp(24px, 8vw, 34px); /* Responsive emoji size */
    background: var(--bg-panel-accent);
    border: 2px solid var(--accent-blue);
    border-radius: var(--border-radius-small);
    position: relative;
    cursor: default;
    transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background 0.3s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2), inset 0 0 4px rgba(0,0,0,0.3);
    opacity: 1; 
}
.slot-cell.anim-popIn {
    animation: popIn 0.4s ease-out forwards;
    opacity: 0;
}

.slot-cell:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 5px 10px rgba(0,0,0,0.3), inset 0 0 6px rgba(0,0,0,0.4), 0 0 8px var(--accent-pink);
    border-color: var(--accent-pink);
}
.slot-cell.clickable-food { cursor: pointer; border-color: var(--accent-green); box-shadow: 0 0 8px var(--accent-green), inset 0 0 4px var(--accent-green); }
.slot-cell.clickable-food:hover { border-color: var(--accent-green); box-shadow: 0 0 12px var(--accent-green), inset 0 0 6px var(--accent-green); transform: scale(1.08); }
.slot-cell.clickable-cat { cursor: pointer; border-color: var(--accent-pink); box-shadow: 0 0 8px var(--accent-pink), inset 0 0 4px var(--accent-pink); }
.slot-cell.clickable-cat:hover { border-color: var(--accent-pink); box-shadow: 0 0 12px var(--accent-pink), inset 0 0 6px var(--accent-pink); transform: scale(1.08); }

.slot-cell .payout-text { position: absolute; bottom: -4px; right: -4px; font-size: 22px; color: var(--accent-yellow); font-weight: bold; opacity: 0; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); pointer-events: none; background: rgba(10,15,30,0.7); padding: 2px 5px; border-radius: 4px 0 4px 0; z-index: 10;} /* Ensure payout text is above cat emoji */
.slot-cell .base-value-text { position: absolute; top: 2px; left: 3px; font-size: 13px; font-weight: 600; text-shadow: 1px 1px 2px rgba(0,0,0,0.7); pointer-events: none; opacity: 0.9; z-index: 1; background: rgba(10,15,30,0.5); padding: 1px 3px; border-radius: 3px;}
.multiplier-value-text { position: absolute; top: 2px; right: 3px; font-size: 15px; font-weight: bold; text-shadow: 0 0 4px var(--accent-pink); pointer-events: none; z-index: 2; background: rgba(10,15,30,0.5); padding: 1px 3px; border-radius: 3px;}
.slot-cell.top-right-locked { background-color: var(--accent-orange); border-color: var(--accent-yellow); box-shadow: 0 0 8px var(--accent-orange), inset 0 0 4px var(--accent-yellow); }

.lock-icon {
    position: absolute;
    top: -2px;
    right: -2px;
    font-size: 18px;
    color: var(--accent-blue);
    cursor: default;
    z-index: 20;
    transition: color 0.2s;
    background: none;
    padding: 0;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
}
.lock-icon.locked-state {
    color: var(--accent-yellow);
}
.lock-icon.no-locks {
    opacity: 0.5;
    color: var(--text-secondary);
}


/* --- New Payout Number Styling --- */
.base-value-text.base-value-base {
    color: var(--text-secondary); /* Light Gray */
}
.base-value-text.base-value-buffed {
    color: var(--accent-yellow); /* Gold */
    text-shadow: 0 0 4px var(--accent-yellow);
}

/* UPDATED: Multiplier payout text style */
.base-value-text.base-value-in-multi-2x,
.base-value-text.base-value-in-multi-3x,
.base-value-text.base-value-in-multi-5x {
    color: var(--accent-yellow); /* Gold color for payout */
    font-size: 16px; /* Larger font size */
    font-weight: 700; /* Bolder */
    text-shadow: 0 0 4px var(--accent-yellow), 0 0 2px rgba(0,0,0,0.5);
}


/* --- Controls & Buttons --- */
.controls {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-direction: row;
    justify-content: center;
    margin-top: 8px; 
    margin-bottom: 8px; 
    width: 100%;
}
.btn {
    padding: 10px 24px; font-size: 16px; border: none; border-radius: var(--border-radius-small); cursor: pointer;
    transition: all 0.25s ease;
    box-shadow: 0 3px 6px rgba(0,0,0,0.3), inset 0 -2px 2px rgba(0,0,0,0.2);
    font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;
    background: linear-gradient(145deg, var(--accent-blue), #00a8c8);
    color: var(--bg-main);
}
.btn:hover:not(:disabled) {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 5px 10px rgba(0,0,0,0.4), inset 0 -1px 2px rgba(0,0,0,0.1), 0 0 8px var(--accent-blue);
    filter: brightness(1.1);
}
.btn:active:not(:disabled) {
    transform: translateY(0px) scale(0.98);
}
.btn-spin.btn-spin-lucky {
    background: linear-gradient(135deg, var(--accent-pink), var(--accent-yellow)) !important;
    border-color: var(--accent-pink) !important;
    color: var(--bg-main) !important;
    box-shadow: 0 0 8px var(--accent-pink), 0 0 4px var(--accent-yellow);
}
#lucky-btn {
    padding: 8px 14px;
    font-size: 13px;
    line-height: 1.2;
    flex-shrink: 0;
}
#spin-btn {
    min-width: 160px;
}


.coin-display {
    font-size: 18px;
    font-weight: bold;
    color: var(--text-primary);
    margin-top: 12px; 
    text-align: center;
}

.inventory-window {
    width: 100%;
    margin-top: 15px;
    padding: 12px;
    background: var(--bg-panel-accent);
}
.inventory-content {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    font-size: 16px;
}
.inventory-item {
    padding: 4px 7px;
    background: var(--bg-panel);
    border-radius: var(--border-radius-small);
    box-shadow: var(--shadow-subtle);
    color: var(--text-secondary);
}
.inventory-item.clickable {
    cursor: pointer;
    color: var(--accent-blue);
    transition: color 0.2s, transform 0.2s;
}
.inventory-item.clickable:hover {
    color: var(--accent-pink);
    transform: scale(1.05);
}
.inventory-item.clickable.inventory-item-gift {
    color: var(--accent-yellow);
    animation: yellowGlow 1.5s infinite;
}
.inventory-item.clickable[style*="opacity: 0.7"] {
    cursor: not-allowed;
    color: var(--text-secondary);
    transform: none; /* Prevent hover scale on disabled-like items */
}

/* --- Modals --- */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.85); /* Slightly darker */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    transition: opacity 0.3s ease;
    padding: 15px;
    box-sizing: border-box;
}
.modal-overlay.hidden {
    opacity: 0;
    pointer-events: none;
}

.modal-window {
    width: 95%;
    max-width: 550px;
    max-height: 90vh;
    position: relative;
    display: flex;
    flex-direction: column;
    padding: 15px; /* Added padding to modal window itself */
}
.modal-title {
    font-size: 20px;
    color: var(--accent-blue);
    text-align: center;
    margin: 0 0 15px 0; /* Adjusted margin */
    padding-bottom: 8px;
    border-bottom: 1px solid var(--accent-blue);
}


.modal-close-btn {
    position: absolute;
    top: 8px;
    right: 12px;
    font-size: 28px;
    color: var(--text-secondary);
    background: none;
    border: none;
    cursor: pointer;
    transition: color 0.2s ease;
    line-height: 1;
    z-index: 1001;
}
.modal-close-btn:hover {
    color: var(--accent-pink);
}
.modal-content {
    overflow-y: auto;
    font-size: 14px;
    line-height: 1.6;
    color: var(--text-primary);
    text-align: left; /* Default for modals */
    padding: 8px;
}
#guide-selection-modal-content {
    text-align: center; /* Center text for simple modals */
}
.modal-content strong { /* Ensure strong tag is colored in modal */
    color: var(--accent-yellow);
}
.payout-option {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 4px;
    background-color: var(--bg-panel-accent);
    transition: all 0.3s ease;
    margin: 0 4px;
}
.payout-option.highlight {
    color: var(--accent-yellow);
    text-shadow: 0 0 6px var(--accent-yellow);
    transform: scale(1.1);
    background-color: transparent;
    font-weight: bold;
}

/* Updated Guide Content Styles */
#guide-back-btn {
    display: block;
    width: 80%;
    margin: 0 auto 15px auto;
    padding: 8px 16px;
    font-size: 14px;
}
.guide-topic-content h4 {
    font-size: 18px;
    color: var(--accent-blue);
    margin-top: 12px;
    margin-bottom: 8px;
    border-bottom: 1px solid var(--accent-blue);
    padding-bottom: 4px;
    text-align: left;
}
.guide-topic-content h4:first-child {
    margin-top: 0;
}
.guide-topic-content p {
    margin-bottom: 8px;
    text-align: left;
}
.guide-topic-content ul {
    list-style-type: disc;
    margin-left: 18px;
    margin-bottom: 8px;
    text-align: left;
}
.guide-topic-content li {
    margin-bottom: 4px;
}
.guide-topic-content strong {
    color: var(--accent-yellow);
    font-weight: 600;
}

/* Gift Choice Modal */
#gift-choice-content h4 {
    font-size: 20px;
    color: var(--accent-yellow);
    text-align: center;
    border: none;
    margin-bottom: 8px;
}
#gift-choice-content p {
    text-align: center;
    color: var(--text-secondary);
    margin-bottom: 15px;
}
.gift-choices-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
    align-items: center;
}
.gift-choices-container .btn {
    width: 90%;
    font-size: 14px;
    padding: 10px 18px;
    text-transform: none;
}


/* Cosmic Theme Specifics */
body.cosmic-theme {
    --bg-main: #1D0C2C;
    --bg-panel: #2D1A4C;
    --bg-panel-accent: #3D2A6C;
    --text-primary: #E8E0F8;
    --text-secondary: #C0B0E0;
    --accent-blue: #A080FF; /* Cosmic Blue/Purple */
    --accent-pink: #FF80F0; /* Cosmic Pink */
    --accent-yellow: #F8F0A0; /* Cosmic Yellow */
    --accent-green: #80F8C0; /* Cosmic Green */
    --accent-orange: #FFB070; /* Cosmic Orange */
    --accent-red: #FF70A0; /* Cosmic Red */
    --shadow-color: rgba(160, 128, 255, 0.15);
    --shadow-color-pink: rgba(255, 128, 240, 0.15);
}
body.cosmic-theme #game-main-title.upgrade-mode-active {
    color: var(--accent-pink); /* Cosmic Pink title */
    text-shadow: 0 0 6px var(--accent-pink), 0 0 12px var(--accent-pink), 0 0 20px var(--accent-pink);
}
body.cosmic-theme .slot-cell { border-color: var(--accent-blue); } /* Cosmic themed border */
body.cosmic-theme .power-meter-fill { background: linear-gradient(to right, var(--accent-pink), var(--accent-blue)); }
body.cosmic-theme #power-meter-indicator-icon { color: var(--accent-blue); animation: accentGlow 2s infinite; } /* Glow for cosmic power */
body.cosmic-theme .buff-countdown { color: var(--accent-yellow); animation: limeGlow 1.5s infinite alternate; } /* Use lime for countdowns in cosmic for contrast */


/* Quantum Theme Specifics */
body.quantum-theme {
    --bg-main: #282c34; /* Dark Gray */
    --bg-panel: #3a3f4b; /* Mid Gray */
    --bg-panel-accent: #4a4f5b; /* Lighter Gray */
    --text-primary: #E0E8F0; /* Light Bluish Gray Text */
    --text-secondary: #A8B0C0; /* Mid Bluish Gray Text */
    --accent-blue: var(--accent-lime); /* Lime for primary accent in quantum */
    --accent-pink: #80F8A8; /* Using a slightly different green for pink's role if needed */
    --accent-yellow: #D0F8A0; /* Lighter lime/yellow */
    --accent-green: var(--accent-lime); /* Main Green is Lime */
    --accent-orange: #B0F888;
    --accent-red: #F88888;
    --accent-lime: #A0F800; /* Explicitly defined Lime */

    --shadow-color: rgba(160, 248, 0, 0.2); /* Lime glow */
    --shadow-color-pink: rgba(128, 248, 168, 0.2); /* Lighter green for secondary glow if needed */
}
body.quantum-theme #game-main-title.upgrade-mode-active {
    color: var(--accent-lime);
    text-shadow: 0 0 6px var(--accent-lime), 0 0 12px var(--accent-lime), 0 0 20px var(--accent-lime);
}
body.quantum-theme .slot-cell { border-color: var(--accent-lime); }
body.quantum-theme .power-meter-fill { background: linear-gradient(to right, var(--accent-lime), #6AAE28); }
body.quantum-theme #power-meter-indicator-icon { color: var(--accent-lime); animation: limeGlow 2s infinite; }
body.quantum-theme .buff-countdown { color: var(--accent-lime); animation: limeGlow 1.5s infinite alternate; }
body.quantum-theme .shop-item-btn {
    background-color: var(--accent-lime); border-color: var(--accent-lime); color: var(--bg-main);
}
body.quantum-theme .shop-item-btn:disabled {
     background-color: var(--accent-lime); border-color: var(--accent-lime); color: var(--bg-main);
     filter: brightness(0.85); opacity: 0.6;
}
body.quantum-theme .investment-ui input[type="range"],
body.quantum-theme .takeout-ui input[type="range"] {
    accent-color: var(--accent-lime);
}


/* Multiplier Slot Visuals (New Solid Backgrounds) */
.slot-cell.multi-2x {
    background-color: var(--multiplier-2x-color);
    border-color: var(--multiplier-2x-color) !important;
    box-shadow: 0 0 8px var(--multiplier-2x-color), inset 0 0 6px rgba(255,255,255,0.2);
}
.slot-cell.multi-3x {
    background-color: var(--multiplier-3x-color);
    border-color: var(--multiplier-3x-color) !important;
    box-shadow: 0 0 8px var(--multiplier-3x-color), inset 0 0 6px rgba(255,255,255,0.2);
}
.slot-cell.multi-5x {
    background-color: var(--multiplier-5x-color);
    border-color: var(--multiplier-5x-color) !important;
    box-shadow: 0 0 8px var(--multiplier-5x-color), inset 0 0 6px rgba(255,255,255,0.2);
}
/* Multiplier Text Number Styling */
.slot-cell.multi-2x .multiplier-value-text,
body.cosmic-theme .slot-cell.multi-2x .multiplier-value-text,
body.quantum-theme .slot-cell.multi-2x .multiplier-value-text {
    color: var(--multiplier-2x-color);
    text-shadow: 0 0 3px #fff, 0 0 5px #fff;
    background: rgba(255,255,255,0.15);
}
.slot-cell.multi-3x .multiplier-value-text,
body.cosmic-theme .slot-cell.multi-3x .multiplier-value-text,
body.quantum-theme .slot-cell.multi-3x .multiplier-value-text {
    color: var(--multiplier-3x-color);
    text-shadow: 0 0 3px #fff, 0 0 5px #fff;
    background: rgba(255,255,255,0.15);
}
.slot-cell.multi-5x .multiplier-value-text,
body.cosmic-theme .slot-cell.multi-5x .multiplier-value-text,
body.quantum-theme .slot-cell.multi-5x .multiplier-value-text {
    color: var(--multiplier-5x-color);
    text-shadow: 0 0 3px #fff, 0 0 5px #fff;
    background: rgba(255,255,255,0.15);
}


.max-feathers {
    color: var(--accent-yellow);
    text-shadow: 0 0 4px var(--accent-yellow);
}

/* Schrodinger Cat Effect for Quantum Mode */
.schrodinger-cat-effect {
    position: relative; /* Needed for pseudo-element positioning */
    /* Distinct visual cue for the 10x cell */
    box-shadow: 0 0 10px var(--accent-lime), 0 0 18px var(--accent-lime), inset 0 0 6px var(--accent-lime) !important;
    border: 2px dashed var(--accent-lime) !important; /* Dashed lime border */
    background-color: rgba(160, 248, 0, 0.1) !important; /* Slight lime tint */
}

.schrodinger-cat-effect::after {
    content: "🐈"; /* Schrodinger's Cat Emoji */
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 50px; /* Larger size */
    z-index: 5; 
    pointer-events: none;

    /* New gradient overlay effect */
    background: linear-gradient(45deg, var(--accent-lime), var(--accent-green));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    opacity: 0.8; /* Less transparent */
    text-shadow: none; /* Remove previous shadow */
}
